Title: Creating an Earth
Date: 2012-10-27 19:07:00
Tags: 
Category: old
Slug: creating-an-earth
Author: Brian

<div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-GIQN6QGw6T8/UIxWmYKvaRI/AAAAAAAAABU/vltgjZeUJus/s1600/116.png" imageanchor="1" style="clear: right; float: right; margin-bottom: 1em; margin-left: 1em;"><img border="0" height="200" src="http://2.bp.blogspot.com/-GIQN6QGw6T8/UIxWmYKvaRI/AAAAAAAAABU/vltgjZeUJus/s200/116.png" width="200" /></a></div><br />A while ago I decided I wanted to create something that looks like the surface of a planet, complete with continents &amp; oceans and all. Since I've only been on a small handful of planets, I decided that I'd approximate this by creating something like the Earth on the computer (without cheating and just copying the real Earth).&nbsp; <br /><br />Where should I start? Well, let's see what the facts we know about the Earth tell us about how to create a new planet on the computer. <br /><br /><a name='more'></a><b>Observation 1</b>: Looking at a map of the Earth, we only see the heights of the surface. <br /><br />So let's describe just the heights of the Earth's surface. <br /><br /><b>Observation 2 </b>: The Earth is a sphere. <br /><br />So (wait for it) we need to describe the height on a spherical surface. <br /><br />Now we can recast our problem of making an Earth more precisely mathematically. We want to know the heights of the planet's surface at each point on the Earth. So we're looking for field (the height of the planet) defined on the surface of a sphere (the different spots on the planet). <br /><br />Just like a function on the real line can be expanded in terms of its Fourier components, almost any function on the surface of a sphere can be expanded as a sum of spherical harmonics Y<span style="font-size: x-small;"><i>lm</i></span>. This means we can write the height <i>h</i> of our planets surfaces as <br /><br />\[<br />h(\theta, \phi) = \sum A_{lm}Y_l^m(\theta, \phi) \quad (1)<br />\]<br />If we figure out what the coefficients A of the sum should be, then we can start making some Earths! Let's see if we can use some other facts about the Earth's surface to get get a handle on what coefficients to use. <br /><br /><b> Observation 3</b>: I don't know every detail of the Earth's surface, whose history is impossibly complicated. <br /><br />I'll capture this lack-of-knowledge by describing the surface of our imaginary planet as some sort of random variable. Equation (1) suggests that we can do this by making the coefficients <i>A</i> random variables. At some point we need to make an executive decision on what type of random variable we'll use. For various reasons, <a href='#footnote1'>[1]</a> I decided I'd use a Gaussian random variable with mean 0 and standard deviation <i>a<span style="font-size: x-small;">lm</span></i>:<br />\[<br />A_{lm} = a_{lm} N(0,1)<br />\]<br />(Here I'm using the notation that <i>N(m,v)</i> is a normal or Gaussian random variable with mean <i>m</i> and variance <i>v</i>. If you multiply a Gaussian random variable by a constant <i>a</i>, it's the same as multiplying the variance by <i>a^2</i>, so <i>a*N(0,1)</i> and <i>N(0,a^2)</i> are the same thing.)<br /><br /><b> Observation 4</b>: The heights of the surface of the Earth are more-or-less independent of their position on the Earth. <br /><br />In keeping with this, I'll try to use coefficients <i>a<span style="font-size: x-small;">lm</span></i> that will give me a random field that is is isotropic on average. This seems hard at first, so let's just make a hand-waving argument. Looking at some <a href="http://en.wikipedia.org/wiki/Spherical_harmonics">pretty pictures</a> of spherical harmonics, we can see that each spherical harmonic of degree l has about l stripes on it, independent of m. So let's try using alm's that depend only on l, and are constant if just m changes. <a href='footnote2'>[2]</a>. Just for convenience, we'll pick this constant to be <i>l</i> to some power <i>-p</i>:<br />\[<br />a_{lm} = l^{-p} \quad \textrm{ or}<br />\]\[<br />h(\theta, \phi) = \sum_{l,m} N_{lm}(0,1) l^{-p} Y_l^m(\theta, \phi) \quad (2)<br />\]<br /><br />At this point I got bored &amp; decided to see what a planet would look like if we didn't know what value of p to use. So below is a movie of a randomly generated "planet" with a fixed choice of random numbers, but with the power<i> p</i> changing. <br /><div class="separator" style="clear: both; text-align: center;"><object width="320" height="266" class="BLOG_video_class" id="BLOG_video-35e95347156e2467" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0"><param name="movie" value="//www.youtube.com/get_player"><param name="bgcolor" value="#FFFFFF"><param name="allowfullscreen" value="true"><param name="flashvars" value="flvurl=http://redirector.googlevideo.com/videoplayback?id%3D35e95347156e2467%26itag%3D5%26source%3Dblogger%26app%3Dblogger%26cmo%3Dsensitive_content%253Dyes%26ip%3D0.0.0.0%26ipbits%3D0%26expire%3D1363446061%26sparams%3Did,itag,source,ip,ipbits,expire%26signature%3DAF98EECA6723029623AA4A4FD1B6F8916C6F45BE.B069BD3B47D585FF3F379B7FC023C17C3FB0C764%26key%3Dck2&amp;iurl=http://video.google.com/ThumbnailServer2?app%3Dblogger%26contentid%3D35e95347156e2467%26offsetms%3D5000%26itag%3Dw160%26sigh%3D3tMKuCkA0PvX3Rh_465wdL2miwg&amp;autoplay=0&amp;ps=blogger"><embed src="//www.youtube.com/get_player" type="application/x-shockwave-flash" width="320" height="266" bgcolor="#FFFFFF" flashvars="flvurl=http://redirector.googlevideo.com/videoplayback?id%3D35e95347156e2467%26itag%3D5%26source%3Dblogger%26app%3Dblogger%26cmo%3Dsensitive_content%253Dyes%26ip%3D0.0.0.0%26ipbits%3D0%26expire%3D1363446061%26sparams%3Did,itag,source,ip,ipbits,expire%26signature%3DAF98EECA6723029623AA4A4FD1B6F8916C6F45BE.B069BD3B47D585FF3F379B7FC023C17C3FB0C764%26key%3Dck2&iurl=http://video.google.com/ThumbnailServer2?app%3Dblogger%26contentid%3D35e95347156e2467%26offsetms%3D5000%26itag%3Dw160%26sigh%3D3tMKuCkA0PvX3Rh_465wdL2miwg&autoplay=0&ps=blogger" allowFullScreen="true" /></object></div><br />As the movie starts (p=0), we see random uncorrelated heights on the surface <a href='footnote3'>[5]</a>. As the movie continues and p increases, we see the surface smooth out rapidly. Eventually, after p=2 or so, the planet becomes very smooth and doesn't look at all like a planet. So the "correct" value for p is somewhere above 0 (too bumpy) and below 2 (too smooth). Can we use more observations about Earth to predict what a good value of p should be?<br /><br /><b>Observation 5</b>: The elevation of the Earth's surface exists everywhere on Earth (duh). <br /><br />So we're going to need our sum to exist. How the hell are we going to sum that series though! Not only is it random, but it also depends on where we are on the planet! <br /><br />Rather than try to evaluate that sum everywhere on the sphere, I decided that it would be easiest to evaluate the sum at the "North Pole" at <i>theta=0</i>. Then, if we picked our coefficients right, this should be statistically the same as any other point on the planet. <br /><br />Why do we want to look at <i>theta = 0</i>? Well, if we look back at the <a href="http://en.wikipedia.org/wiki/Spherical_harmonics">wikipedia entry</a> for spherical harmonics, we see that <br />\[<br />Y_l^m = \sqrt{ \frac{2 l + 1}{4\pi}\frac{(l-m)!}{(l+m)!}} e^{im\phi}P^m _ l(\cos\theta) \quad (3)<br />\]<br /><br />That doesn't look too helpful -- we've just picked up another special function Plm that we need to worry about. But there is a trick with these special functions Plm: at theta = 0, Plm is 0 if m isn't 0, and Pl0 is 1. So at theta = 0 this is simply:<br />\[<br />Y_l^m(\theta = 0) = \bigg \{ ^{\sqrt{(2l+1)/4\pi},\, m=0}_{0,\,m \ne 0}<br />\]<br /><br />Now we just have, from every equation we've written down:<br />\[<br />h(\theta = 0) = \sum_l \times l^{-p} \times \sqrt{(2l+1)/4\pi }\times N(0,1) \]\[<br />\quad \qquad =&nbsp; \times \frac 1 {\sqrt{4\pi}} \times \sum_l N(0,l^{-2p}(2l+1)) \]\[<br />\quad \qquad =&nbsp; \times \frac 1 {\sqrt{4\pi}} \times N(0,\sum_l l^{-2p}(2l+1) ) \] \[<br />\quad \qquad = \times \frac 1 {\sqrt{4\pi}} \sqrt{\sum_l l^{-2p}(2l+1)}<br />\times N(0,1) \] \[<br />\quad \qquad \sim \sqrt{\sum_l l^{-2p+1}} N(0,1) \qquad (4)<br />\] <br /><br />So for the surface of our imaginary planet to exist, we had better have that sum converge, or <i>-2p+1 &lt; -1 (p &gt; 1)</i>. <br /><br />And we've also learned something else!!! Our model always gives back a Gaussian height distribution on the surface. Changing the coefficients changes the variance of distribution of heights, but that's all it does to the distribution. Evidently if we want to get a non-Gaussian distribution of heights, we'd need to stretch our surface after evaluating the sum.<br /><br />Well, what does the height distribution look like from my simulated planets? Just for the hell of it, I went ahead and generated ~400 independent surfaces at ~40 different values for the exponent <i>p</i>, looking at the first 22,499 terms in the series. From these surfaces I reconstructed the measured distributions; I've combined them into a movie which you can see below. <br /><div class="separator" style="clear: both; text-align: center;"><br /><object width="320" height="266" class="BLOG_video_class" id="BLOG_video-31e5890cc071aa2f" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0"><param name="movie" value="//www.youtube.com/get_player"><param name="bgcolor" value="#FFFFFF"><param name="allowfullscreen" value="true"><param name="flashvars" value="flvurl=http://redirector.googlevideo.com/videoplayback?id%3D31e5890cc071aa2f%26itag%3D5%26source%3Dblogger%26app%3Dblogger%26cmo%3Dsensitive_content%253Dyes%26ip%3D0.0.0.0%26ipbits%3D0%26expire%3D1363446061%26sparams%3Did,itag,source,ip,ipbits,expire%26signature%3D5521ED1527A9440D68709DEDB1AFDE082DC7D49F.388560830F4B1E249D8B9436D8E429D7540E9E07%26key%3Dck2&amp;iurl=http://video.google.com/ThumbnailServer2?app%3Dblogger%26contentid%3D31e5890cc071aa2f%26offsetms%3D5000%26itag%3Dw160%26sigh%3DkgENNT4M2p-G8XR472t6cu_O3Mo&amp;autoplay=0&amp;ps=blogger"><embed src="//www.youtube.com/get_player" type="application/x-shockwave-flash" width="320" height="266" bgcolor="#FFFFFF" flashvars="flvurl=http://redirector.googlevideo.com/videoplayback?id%3D31e5890cc071aa2f%26itag%3D5%26source%3Dblogger%26app%3Dblogger%26cmo%3Dsensitive_content%253Dyes%26ip%3D0.0.0.0%26ipbits%3D0%26expire%3D1363446061%26sparams%3Did,itag,source,ip,ipbits,expire%26signature%3D5521ED1527A9440D68709DEDB1AFDE082DC7D49F.388560830F4B1E249D8B9436D8E429D7540E9E07%26key%3Dck2&iurl=http://video.google.com/ThumbnailServer2?app%3Dblogger%26contentid%3D31e5890cc071aa2f%26offsetms%3D5000%26itag%3Dw160%26sigh%3DkgENNT4M2p-G8XR472t6cu_O3Mo&autoplay=0&ps=blogger" allowFullScreen="true" /></object></div><br />As you can see from the movie, the distributions look like Gaussians. The fits from Eq. (4) are overlaid in black dotted lines. (Since I can't sum an infinite number of spherical harmonics with a computer, I've plotted the fit I'd expect from just the terms I've summed. ) As you can see, they are all close to Gaussians. Not bad. Let's see what else we can get. <br /><br /><b>Observation 6</b>: According to some famous people, the <a href="http://en.wikipedia.org/wiki/How_Long_Is_the_Coast_of_Britain%3F_Statistical_Self-Similarity_and_Fractional_Dimension">Earth's surface is probably a fractal whose coastlines are non-differentiable</a>.<br /><br /><br />This means that we want a value of p that will make our surface rough enough so that its gradient doesn't exist (the derivative of the sum of Eq. (2) doesn't converge). At this point I'm getting bored with writing out calculations, so I'm just going to make some scaling arguments. <br /><br />From Eq. (3), we know that each of the spherical harmonics Ylm is related to a polynomial of degree l in cos(theta). So if we take a derivative, I'd expect us to pick up another factor of l each time. Following through all the steps of Eq. (4) we find<br />\[<br />\vec{\nabla}h \sim \sqrt{\sum_l l^{-2p+3}}\vec{N}(0,1) \quad ,<br />\]<br />which converges for p &gt; 2. So for our planet to be "fractal," we want <i>1&lt;p&lt;2</i>. Looking at the first movie, this seems reasonable. <br /><br /><b>Observation 7</b>: 70% of the Earth's surface is under water. <br /><br />On Earth, we can think of the points underwater as all those points below a certain threshold height. So let's threshold the heights on our sphere. If we want 70% of our generated planet's surface to be under water, Eq (4) and the <a href="http://en.wikipedia.org/wiki/Cumulative_distribution_function">cumulative distribution function </a>of a <a href="http://en.wikipedia.org/wiki/Normal_distribution">Gaussian distribution</a> tells us that we want to pick a critical height <i>H</i> such that <br />\[<br />\frac 1 2 \left[ 1 + \textrm{erf}(H/\sqrt{2\sigma^2}) \right] = 0.7 \quad \textrm{or}<br />\] \[<br />H = \sqrt{2\sigma^2}\textrm{erf}^{-1}(0.4)<br />\] \[<br />\sigma^2 = \frac 1 {4\pi} \sum_l l^{-2p}(2l+1) \quad (5)\, ,<br />\]<br />where <i>erf()</i> is a special function called the error function, and erf-1 is its inverse. We can evaluate these numerically (or by using some <a href="http://en.wikipedia.org/wiki/Error_Function#Asymptotic_expansion">dirty tricks</a> if we're feeling especially masochistic).<br /><br />So for our generated planet, let's call all the points with a height larger than H "land," and all the points with a height less than H "ocean." Here is what it looks like for a planet with<i> p=0, p=1</i>, and <i>p=2</i>, plotted with the same <a href="http://en.wikipedia.org/wiki/Sinusoidal_projection">Sanson projection</a> as before. <br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://1.bp.blogspot.com/-bWQBhSTYGAc/UIxZyk1d9dI/AAAAAAAAABk/FSZtM2jZ24g/s1600/allContinents.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="400" src="http://1.bp.blogspot.com/-bWQBhSTYGAc/UIxZyk1d9dI/AAAAAAAAABk/FSZtM2jZ24g/s400/allContinents.png" width="258" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Top to bottom: p=0, p=1, and p=2. I've colored all the "water" (positions with heights &lt; <i>H </i>as given in Eq. (5) ) blue and all the land (heights &gt; <i>H</i>) green. </td></tr></tbody></table><br /><br />You can see that the the total amount of land area is roughly constant among the three images, but we haven't fixed how it's distributed. Looking at the map above for <i>p=0</i>, there are lots of small "islands" but no large contiguous land masses. For <i>p=2</i>, we see only one contiguous land mass (plus one 5-pixel island), and <i>p=1</i> sits somewhere in between the two extremes. None of these look like the Earth, where there are a few large landmasses but many small islands. From our previous arguments, we'd expect something between p=1 and p=2 to look like the Earth, which is in line with the above picture. But how do we decide which value of p to use? <br /><br /><b>Observation 8</b>: The Earth has 7 continents <br /><br />This one is more vague than the others, but I think it's the coolest of all the arguments.<br /><br />How do we compare our generated planets to the Earth? The Earth has 7 continents that comprise 4 different contiguous landmasses. In order, these are 1) Europe-Asia-Africa, 2) North- and South- America, 3) Antartica, and 4) Australia, with a 5th Greenland barely missing out. In terms of fractions of the Earth's surface, Google tells us that Australia covers 0.15% of the Earth's total surface area, and Greenland covers 0.04%. So let's define a "continent" as any contiguous landmass that accounts for more than 0.1% of the planet's total area. Then we can ask: What value of <i>p</i> gives us a planet with 4 continents? <br /><br />I have no idea how to calculate exactly what that number would be from our model, but I can certainly measure it from the simulated results. I went ahead and counted the number of continents in the generated planets. <br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-eGMLLNCMVRU/UIxbi6MYw9I/AAAAAAAAAB8/BFVHUaEctBA/s1600/numContinents.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="300" src="http://3.bp.blogspot.com/-eGMLLNCMVRU/UIxbi6MYw9I/AAAAAAAAAB8/BFVHUaEctBA/s400/numContinents.png" width="400" /></a></div><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-W3qT-_LOlT4/UIxaxqd1b9I/AAAAAAAAABs/HZEMht7uzlU/s1600/numContinents.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><br /></a></div><br />The results are plotted above. The solid red line is the median values of the number of continents, as measured over 400 distinct worlds at 40 different values of p. The red shaded region around it is the band containing the upper and lower quartiles of the number of continents. For comparison, in black on the right y-axis I've also plotted the log of the total number of landmasses at the resolution I've used. <br /><br />The number of continents has a resonant value of p -- if p is too small, then there are many landmasses, but none are big enough to be continents. Conversely, if p is too large, then there is only one huge landmass. Somewhere in the middle, around p=0.5, there are about 20 continents, at least when only the first ~23000 terms in the series are summed. <br /><br />Looking at the curve, we see that there are roughly two places where there are 4 continents in the world -- at p=0.1 and at p=1.3. Since p=0.1 doesn't converge, and since p=0.1 will have way too many landmasses, it looks like a generated Earth will look the best if we use a value of <i>p=</i>1.3<br /><br />And that's it. For your viewing pleasure, here is a video of three of these planets below, complete with water, continents, and mountains. <a href='footnote4'>[4]</a><br /><br /><div class="separator" style="clear: both; text-align: center;"><object width="320" height="266" class="BLOG_video_class" id="BLOG_video-6a9be1177a34c1ac" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0"><param name="movie" value="//www.youtube.com/get_player"><param name="bgcolor" value="#FFFFFF"><param name="allowfullscreen" value="true"><param name="flashvars" value="flvurl=http://redirector.googlevideo.com/videoplayback?id%3D6a9be1177a34c1ac%26itag%3D5%26source%3Dblogger%26app%3Dblogger%26cmo%3Dsensitive_content%253Dyes%26ip%3D0.0.0.0%26ipbits%3D0%26expire%3D1363446061%26sparams%3Did,itag,source,ip,ipbits,expire%26signature%3D747E6D5470929B602967CF18E2AF6C1141FB406F.A5B1C4914DC5A85D8DEC317B3A43388B3B433287%26key%3Dck2&amp;iurl=http://video.google.com/ThumbnailServer2?app%3Dblogger%26contentid%3D6a9be1177a34c1ac%26offsetms%3D5000%26itag%3Dw160%26sigh%3DSmKLwfsySkqrRT1--7zWT17HMfI&amp;autoplay=0&amp;ps=blogger"><embed src="//www.youtube.com/get_player" type="application/x-shockwave-flash" width="320" height="266" bgcolor="#FFFFFF" flashvars="flvurl=http://redirector.googlevideo.com/videoplayback?id%3D6a9be1177a34c1ac%26itag%3D5%26source%3Dblogger%26app%3Dblogger%26cmo%3Dsensitive_content%253Dyes%26ip%3D0.0.0.0%26ipbits%3D0%26expire%3D1363446061%26sparams%3Did,itag,source,ip,ipbits,expire%26signature%3D747E6D5470929B602967CF18E2AF6C1141FB406F.A5B1C4914DC5A85D8DEC317B3A43388B3B433287%26key%3Dck2&iurl=http://video.google.com/ThumbnailServer2?app%3Dblogger%26contentid%3D6a9be1177a34c1ac%26offsetms%3D5000%26itag%3Dw160%26sigh%3DSmKLwfsySkqrRT1--7zWT17HMfI&autoplay=0&ps=blogger" allowFullScreen="true" /></object></div><br /><br /><br /><p id='footnote1'>[1] Since I wanted a random surface, I wanted to make the mean of each coefficient 0. Otherwise we'd get a deterministic part of our surface heights. I picked a distribution that's symmetric about 0 because on Earth the bottom of the oceans seem roughly similar in terms of changes in elevation. I wanted to pick a stable distribution &amp; independent coefficients because it makes the sums that come up easier to evalutate. Finally, I picked a Gaussian, as opposed to another stable distribution like a Lorentzian, because the tallest points on Earth are finite, and I wanted the variance of the planet's height to be defined. </p><p id='footnote2'>[2] We could make this rigorous by showing that a rotated spherical harmonic is orthogonal to other spherical harmonics of a different degree <i>l</i>, but you don't want to see me try.</p><p id='footnote3'>[3]Actually p=0 should correspond to completely uncorrelated delta-function noise. (You can convince yourself by looking at the spherical harmonic expansion for a delta-function.) The reason that the bumps have a finite width is that I only summed the first 22,499 terms in the series (l=150 and below). So the size of the bumps gives a rough idea of my resolution. </p><p id='foonote4'>[4] For those of you keeping score at home, it took me more than 6 days to figure out how to make these planets.
